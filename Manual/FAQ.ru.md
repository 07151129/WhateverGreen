#### Краткий FAQ:
- _Когда использовать WhateverGreen?_  
В macOS 10.11 и выше (возможно и в 10.10) с видеокартами ATI/AMD 5xxx и новее.  
Проверить все серии видеокарт и их конфигурации возможности нет, используйте на свой страх и риск.

- _Как получить подробный лог?_  
Установить DEBUG версии WhateverGreen и Lilu, добавить `-raddbg -liludbg` в аргументы загрузки. После запуска выполнить команду в терминале:  
`log show --predicate 'process == "kernel" AND (eventMessage CONTAINS "WhateverGreen" OR eventMessage CONTAINS "Lilu")' --style syslog --source`  
Для macOS 10.11 и старее использовать:  
`cat /var/log/system.log | egrep '(WhateverGreen|Lilu)'`  
Следует обратить внимание, что если проблема с видеокартой, то лог можно получить через SSH. В этом случае стоит также проверить вывод `kextstat`.

- _Каково состояние поддержки 10.13?_  
В момент выпуска 10.13 находится на стадии тестирования, потому об официальной поддержке речи не идёт. Известны случаи незапуска графики на чипсетах старше Nehalem. Если у вас имеется подобное железо, воздержитесь от обновления. В остальных случаях WhateverGreen может работать, при условии отстутствия значительных изменений в 10.13.

- _Какие прочие аппаратные требования для WhateverGreen?_  
UEFI без использования CSM. В случае отсутствия поддержки UEFI видеокартой, её крайне желательно перешить. Непрошитая карта с высокой долей вероятности создаст проблемы при использовании нескольких мониторов или даже с одним монитором. Используйте материнские платы без UEFI на свой страх и риск. Известны проблемы мультимониторных конфигураций при использовании 2 и более видеокарт.

- _Как прошить видеокарту?_  
Для самого процесса прошивки можно проследовать [этой инструкции](https://www.techpowerup.com/forums/threads/amd-ati-flashing-guide.212849/). Для создания прошивки можно использовать [эту инструкцию](http://www.win-raid.com/t892f16-AMD-and-Nvidia-GOP-update-No-requests-DIY.html). Также существует [утилита](http://www.insanelymac.com/forum/topic/299614-asus-eah6450-video-bios-uefi-gop-upgrade-and-gop-uefi-binary-in-efi-for-many-ati-cards/#entry2042163) и для macOS, но в случае её использование паддинг придётся убирать вручную.

- _В каких случаях стоит ли использовать именной фреймбуфер?_  
Именной фреймбуфер (Baladi, Futomaki, Lotus и др.), включаемый "инжектом Clover" или любым другим способом, не следует использовать _ни при каких обстоятельствах_. Такой способ запуска видеокарты — распространённое заблуждение, приводящее к отключению автоматического конфигурирования множества важных параметров. В результате с высокой долей вероятности видеокарта будет работать неправильно.

- _В каких случаях необходимо использовать собственные коннекторы?_  
В редких случаях видеобиос (например, видеокарты 290, 290X, 370) может быть не совместим с автоматическим детектированием коннекторов, реализованном в кекстах Apple. Для этих случаев в WhateverGreen предусмотрена автоматическая коррекция коннекторов. Тем не менее, если сгенерированные коннекторы не подошли (их можно посмотреть в режиме подробного логирования), то существует возможность указать пользовательские коннекторы  в качестве свойства контроллера видеокарты `connectors`, например, через SSDT. Указывать коннекторы можно как в 24-байтном, так и в 16-байтном формате, они будут адаптированы под запущенную систему. Если нужно указать число коннектров больше или меньше, чем определяется автоматически, то необходимо также указать свойство `connector-count`.

- _Как изменить приоритет мониторов?_  
С видеокартами 7xxx и новее для этого нет необходимости использовать собственные коннекторы. Добавьте свойство контроллера видеокарты `connector-priority`, перечислив sense id (можно посмотреть в режиме подробного логирования) в порядке важности. Данное свойство иногда помогает решить проблемы с мультимониторными конфигурациями. 

- _Какие свойства нужно инжектировать для завода видеокарты?_  
Минимум необходимых! Добавлять нужно устройство `HDAU` в контроллер видеокарты, свойства `hda-gfx` с соответствующим номером числу имеющихся кодеков аудио, по сути всё. Если требуется маскировка на поддерживаемую видеокарту, указывать следует только `device-id`. Разумно добавлять некоторые косметические свойства: `AAPL,slot-name` (отображаемое имя слота в свойствах системы), `@X,AAPL,boot-display` (частично исправляет лого при загрузке), `model` (название видеокарты, если автоматика не справилась).  
Не самый идеальный [пример SSDT](https://github.com/vit9696/WhateverGreen/blob/master/Manual/Sample.dsl) для общего понимания.

- _Когда необходим аргумент загрузки `radpg`?_  
Данный аргумент — замена оригинальному патчу Info.plist AMDRadeonX4000 для запуска некоторых видеокарт 7xxx от igork. WhateverGreen не совместим с Verde.kext, и его нужно удалить. Аргумент позволяет принудительно включить часть флагов технологии power-gating, например, CAIL_DisableGfxCGPowerGating. Значение является битовой маской из CAIL_DisableDrmdmaPowerGating, CAIL_DisableGfxCGPowerGating, CAIL_DisableUVDPowerGating, CAIL_DisableVCEPowerGating, CAIL_DisableDynamicGfxMGPowerGating, CAIL_DisableGmcPowerGating, CAIL_DisableAcpPowerGating, CAIL_DisableSAMUPowerGating. Так `radpg=15` активирует первые четыре ключа.

- _Как изменить название видеокарты?_  
Кекст контроллера (например, AMD6000Controller) при автоматической инициализации заменяет название видеокарты на обобщённое (например, AMD Radeon HD 6xxx). Инжектирование свойств и отключение этого лишь приведёт к сломанному автодетекту коннекторов, потому исключительно не рекомендуется. WhateverGreen пытается автоматически определить название карты, если оно не задано. Если название определяется неверно (например, в случае маскировки device-id или использования новой карты), достаточно указать верное название в свойстве `model`. Все вопросы по корректности автоматического определния должны быть отправлены в [The PCI ID Repository](http://pci-ids.ucw.cz). В исключительных случаях вы можете отправить [патч](https://github.com/vit9696/WhateverGreen/pulls) для [kern_model.cpp](https://github.com/vit9696/WhateverGreen/blob/master/WhateverGreen/kern_model.cpp). На функционирование карты название никак не влияет.

- _Что делать, если видеокарта для просыпания требует нескольких нажатий на клавиатуре?_  
Если это действительно беспокоит, можно подождать чуть дольше или попробовать добавить аргумент загрузки `darkwake=0`.

- _Как понять, что видеокарта инициализируется правильно?_  
Один из наиболее простых показателей — время загрузки. При неправильном заводе загрузка происходит на 30 секунд дольше.

- _Нормально ли иметь в названии движка OpenGL/OpenCL `Prototype`?_  
Да, нормально. В процессе обратной разработки удалось выяснить, что отображаемое название никак не влияет на производительность. Напротив, попытки поменять данное название патчем идентификаторов в кекстах (например, AMDRadeonX4000) могут привести к нестабильной работе системы. Для безалаберно написанных приложений, работающих неправильно с подобными названиями можно использовать `libWhateverName.dylib`.

- _Как использовать IGPU?_  
В большинстве случаев желательно использовать IGPU для декодирования видео (с заводом на фрейм без коннекторов). В случае необходимости дополнительных мониторов возможно активировать IGPU полностью. При использовании IntelGraphicsFixup аргумент загрузки `-radlogo` не требуется.

- _Как получить рабочее аппаратное декодирование видео?_  
Обычно это задача IGPU, заведённой на фрейм без коннекторов. На некоторых видеокартах (например, HD 7870, HD 6670, HD 7970) можно завести аппаратный декодер AMD. Подробности в [FAQ Shiki](https://github.com/vit9696/Shiki/blob/master/FAQ.ru.md). На моделях с принудительным forceOfflineRenderer может потребоваться аргумент загрузки `-shikigva`.

- _Зачем принудительно выставлять 24-битный вывод цвета?_  
На некоторых мониторах нет поддержки 30-битного цвета, при этом видеокарта об этом может не знать. В результате цвета на экране будут мигать с искажениями. Для решения проблемы необходимо либо приобрести другой дисплей, либо добавить аргумент загрузки `-rad24`.  

- _Как заставить работать HDMI звук?_  
В большинстве случаев инжектирования вышеуказанных устройств и свойств достаточно. В некоторых случаях нужно также добавлять свойство `device-id` с поддерживаемым идентификатором в HDAU и патч AppleHDAController. Подробности описаны в [примере SSDT](https://github.com/vit9696/WhateverGreen/blob/master/Manual/Sample.dsl).

- _Могу ли я получить исходный код?_  
Код автодетектирования модели [открыт](https://github.com/vit9696/WhateverGreen/blob/master/WhateverGreen/kern_model.cpp), как и код [Lilu](https://github.com/vit9696/Lilu). Если есть желание и знание, как добавить некоторый функционал, пишите. Например, неплохо бы добавить нормальную совместимость с AMD Switchable Graphics или более подробно разобрать детектирование коннекторов.
